//go:build ignore

package main

import (
	"container/heap"
	"fmt"
	"strings"
)

type visitedNode struct {
	x, y int
	dir  int
}

type pqNode struct {
	cost int
	x, y int
	dir  int
}

type pq []*pqNode

func (q pq) Less(i, j int) bool {
	return q[i].cost < q[j].cost
}

func (q pq) Swap(i, j int) {
	q[i], q[j] = q[j], q[i]
}

func (q pq) Len() int {
	return len(q)
}

func (q *pq) Push(x any) {
	*q = append(*q, x.(*pqNode))
}

func (q *pq) Pop() any {
	old := *q
	n := len(old)
	x := old[n-1]
	*q = old[:n-1]
	return x
}

var _ heap.Interface = (*pq)(nil)

var best *int

func main() {
	m, sx, sy, ex, ey := parseMap(input)

	var queue pq
	visitedNodes := make(map[visitedNode]bool)
	costMap := make(map[visitedNode]int)
	heap.Init(&queue)
	heap.Push(&queue, &pqNode{0, sx, sy, 1})
	for len(queue) > 0 {
		n := heap.Pop(&queue).(*pqNode)
		if _, ok := costMap[visitedNode{n.x, n.y, n.dir}]; !ok {
			costMap[visitedNode{n.x, n.y, n.dir}] = n.cost
		}
		if n.x == ex && n.y == ey && best == nil {
			best = new(int)
			*best = n.cost
		}
		if visitedNodes[visitedNode{n.x, n.y, n.dir}] {
			continue
		}
		visitedNodes[visitedNode{n.x, n.y, n.dir}] = true
		var nx, ny int
		switch n.dir {
		case 0:
			nx, ny = n.x, n.y-1
		case 1:
			nx, ny = n.x+1, n.y
		case 2:
			nx, ny = n.x, n.y+1
		case 3:
			nx, ny = n.x-1, n.y
		}
		if 0 <= ny && ny < len(m) && 0 <= nx && nx < len(m[ny]) && m[ny][nx] != '#' {
			heap.Push(&queue, &pqNode{n.cost + 1, nx, ny, n.dir})
		}
		switch n.dir {
		case 0:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 1:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
		case 2:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 3:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
		}
	}

	queue = nil
	visitedNodes = make(map[visitedNode]bool)
	costMap2 := make(map[visitedNode]int)
	heap.Init(&queue)
	heap.Push(&queue, &pqNode{0, ex, ey, 0})
	heap.Push(&queue, &pqNode{0, ex, ey, 1})
	heap.Push(&queue, &pqNode{0, ex, ey, 2})
	heap.Push(&queue, &pqNode{0, ex, ey, 3})
	for len(queue) > 0 {
		n := heap.Pop(&queue).(*pqNode)
		if _, ok := costMap2[visitedNode{n.x, n.y, n.dir}]; !ok {
			costMap2[visitedNode{n.x, n.y, n.dir}] = n.cost
		}

		if visitedNodes[visitedNode{n.x, n.y, n.dir}] {
			continue
		}
		visitedNodes[visitedNode{n.x, n.y, n.dir}] = true
		var nx, ny int
		switch n.dir {
		case 0:
			nx, ny = n.x, n.y+1
		case 1:
			nx, ny = n.x-1, n.y
		case 2:
			nx, ny = n.x, n.y-1
		case 3:
			nx, ny = n.x+1, n.y
		}
		if 0 <= ny && ny < len(m) && 0 <= nx && nx < len(m[ny]) && m[ny][nx] != '#' {
			heap.Push(&queue, &pqNode{n.cost + 1, nx, ny, n.dir})
		}
		switch n.dir {
		case 0:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 1:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
		case 2:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 3:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
		}
	}

	type pos struct {
		x, y int
	}

	seatMap := map[pos]bool{}

	for y := range m {
		for x := range m[y] {
			for d := 0; d < 4; d++ {
				if c1, ok := costMap[visitedNode{x, y, d}]; ok {
					if c2, ok := costMap2[visitedNode{x, y, d}]; ok {
						fmt.Println(c1, c2)
						if *best == c1+c2 {
							fmt.Println("found", x, y, d)
							seatMap[pos{x, y}] = true
						}
					}
				}
			}
		}
	}

	fmt.Println("costMap", costMap)
	fmt.Println("costMap2", costMap2)

	fmt.Println("seatMap", len(seatMap))
}

func parseMap(input string) ([][]rune, int, int, int, int) {
	var m [][]rune
	var sx, sy, ex, ey int
	for y, l := range strings.Split(input, "\n") {
		m = append(m, []rune(l))
		for x, r := range []rune(l) {
			if r == 'S' {
				sx, sy = x, y
			}
			if r == 'E' {
				ex, ey = x, y
			}
		}
	}
	return m, sx, sy, ex, ey
}

var ex1 = `###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############`

var ex2 = `#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################`

var input = `#############################################################################################################################################
#.#...............#.........#.....#...........#.............#.............#.#.......#.#.........#...........#.......#...........#.........#E#
#.#.#.###########.#.#.#####.#.#.#.###.#####.#.#.#########.#.#.###.###.###.#.#.###.#.#.#.#.###.#.#.#######.#.#####.#.#.#.#.#.###.#.#.#####.#.#
#.#.#.....#.....#...#.....#.#...............#.#...#...#.....#.....#...#.#.#.#.#...#...........#.#.#.....#.#.#...#.#.#.#.#...#...#.#.#...#...#
#.#.#####.#.#######.#.###.#.#.#.#######.###.#.#.#.#.#.#.###########.###.#.#.#.#.###.#####.###.###.#.###.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#####.#
#...#...#.#.....#...#...#.#.....#.....#.#.#...#.#.#.#.#.#.....#.....#.......#.#...#.#...#...#.....#...#.#.#...#.#.#...#.#.#.#.#...#.#.......#
#.###.#.#.#.###.#.#.#####.###.#####.#.#.#.#.###.#.#.#.#.###.#.#.#########.###.###.#.#.#.###.###########.#.#####.#.#######.#.#.#####.#.#######
#...#.#.#.#...#.#.........#.#.......#.#.#.......#.#.#.......................#.#.#.#.#.#...#...#.......#.#.#.....#.......#.#.#...#...#.#.....#
###.#.#.#.###.#.###.#######.#.#.###.###.#.#.#####.#####.#.###.#.#########.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.#####.#####.#.#.###.#.###.#.###.#
#...#.#.#.#.#.#.....#.......#.#.#...#...#.#.....#.....#...#.#.#...........#.....#.#...#.#.#.....#.......#.#.#...#.....#...#.#.#.#...#...#.#.#
#.###.#.#.#.#.###.#.#.#.#####.#.#####.###.#.###.#####.#####.#.###.#######.#######.#####.#.#.#############.#.###.#####.#####.#.#.###.###.#.#.#
#.#...#...#.........................#...#.#...#.#.....#.....#...#.#...........................#...#.................#...#...#.#...#.......#.#
#.#.###.#######.#.#.#######.#.#####.###.###.#.#.#.#####.#######.###.#.###.#.###.#.#.###.#######.#.#.###.#.###.###.#.###.#.#.#.###.#########.#
#.#.#...#.....#.#.........#.....#.#...#...#...#...#...#.......#...#.#.......#.#.#.#...#.........#...#.....#.#.............#.......#.....#...#
#.#.#####.###.#.###.#####.#.#.#.#.###.###.#.#########.#.#####.###.#.#####.###.#.#.###.#.#############.#####.###.#.###.#.#.###.#####.###.#.###
#.........#.#.#...#...#...#.........#...#...#.#.......#.....#...#.#.#...#...#...#.......#.........#...#...#.....#...#...#...#...#...#...#...#
#.#########.#.###.###.#.#####.#######.#.#####.#.###.#######.#.###.#.#.###.#.#.#######.#.#.#######.#####.#.###.###########.#.###.#.###.###.#.#
#.#.#.....#.#.#.......#...#.........#.#.........#...#.....#.#...#...#...#.#.#.#.....#.#.........#.......#...#...........#.#.#.....#.#.#.#.#.#
#.#.#.#.#.#.#.#.###########.#####.#.#.###########.###.###.#.###.#####.#.#.#.#.#.#.#.#.###########.#########.###########.#.#.#.#####.#.#.#.#.#
#.#...#.#...#.#.#.........#.#.....#.#...#.....#...#.....#.#...#...#...#.#.#...#.#.#.#...#.......#.#...#...#.#...#.....#.#.#.#.......#.#...#.#
#.#####.###.#.###.#######.#.#.###.#.#####.###.#.#.#.#####.###.###.#.###.#.#######.#.#####.#####.###.#.#.#.#.#.#.#.#.#.#.###.#.###.###.#####.#
#.......#.#.#...........#...#.#...#.....#...#...#.#...#...#...#.#.#...#...#.....#.#.#.....#.....#...#.#...#.#.#...#...#.#...#...#...#.....#.#
#########.#.#############.###.#######.#.#.#.#########.#.###.###.#.###.#######.#.#.#.#.#####.#.###.###.#.#.#.#.#####.#.#.#.#######.#.#####.#.#
#.#.....#...#...........#.....#.....#.#.#.#.........#.#.....#...#.#...#.....#.#...#.#.....#...#.#...#.#.#...#.#.....#.#.#.......#.#.....#...#
#.#.#.###.###.#.#######.#######.###.###.#.#.#.#####.#.#######.#.#.#.###.###.#.#####.#.#.###.###.#.#.#.#.#####.#.#######.#######.#.###.#####.#
#...#...#.....#.....#.#.........#.#.#...#.....#...#.........#.#.#.......#.#...#...#.#.#...#.#.....#.#...#...#.#.......#.......#.#.#.#.......#
#.#####.#.###.#####.#.###########.#.#.###.#####.#.#########.#.#.#######.#.#####.#.#.#.###.#.#.#####.###.#.#.#.#######.#######.#.#.#.#########
#.#...#.#.......#...#.....#...#.......#.....#...#...#...#...#.#.........#.#.....#...#...#.#.#.....#...#...#.....#...#...#...#...#.........#.#
#.#.#.#.#.#####.#.#######.#.#.#.#############.###.#.###.#.#####.###.#####.#.###########.#.#.#########.#.#######.#.#.###.#.#.#############.#.#
#.#.#...#.....#.#...#...#...#...#.....#.......#...#...#.......#.#.#.#.#...#.#.......#...#.#...#...#...#.#.....#.#.#...#...#.......#.....#...#
###.#####.###.#.###.#.#.#.#######.###.#.#######.#####.#######.#.#.#.#.#.#.#.#.#####.#.###.###.#.#.#.#####.###.###.###.#####.#####.#.#.#####.#
#...#.....#.#...#.#...#.#...#.....#.#...#.......#...#...#...#.#.....#.......#...#...#...#.....#.#.#.#.......#...#...#.....#.........#.......#
#.#.#.###.#.#####.#####.###.#.#####.#######.#####.#.#.#.#.#.#.#####.#.#########.#.###.#.###.#.#.#.#.#.#####.#.#.###.#####.#######.#.#.#######
#.#.#.....#.#.........#.#.#.#...#.#.....#...#.....#.#.#.#.#.#.......#.#.........#...#.#...#.....#.#...#...#...#.........#.......#.#.........#
#.#######.#.#.#######.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.###.#####.###.#######.#####.#####.#######.#####.#.###############.#####.#.#######.#.#
#.#.......#...#...#.....#...#...#...#.#...#.#...#.#.#.#...#.........#.......#...#.#.......#.....#.......#...........#.......#...#.........#.#
#.#.#.###.#.#####.#.#.#.#.###.#######.#####.###.#.#.#####.#####.#.#.#######.###.#.#########.#######################.#.#.###.#.###.#######.#.#
#...#...#.#.......#.#.#.#...#.......#...#...#...#.#.#...#.....#.#.#.......#...#.................#.........#.......#...#...#.#...#.......#.#.#
#.###.#.#.#######.#.###.###########.#.#.#.###.###.#.#.#.#.###.#.#.#.#####.###.#.#.###########.#.#.###.###.#.#####.#######.###.#.###.###.#.#.#
#.....#.#.........#...#.....#.....#.#.#.#.#...#...#...#.#.#...#...#.....#.#.#...#.#...........#...#...#.....#.#.........#.....#...#...#.....#
#####.#.#.#########.#.#####.#.###.#.#.#.###.###.#.#####.###.#####.#####.#.#.#######.#########.#####.###.#####.#.#####.#####.#.###.#.#####.###
#.....#.#...#.#...#.......#.....#.#.#.#.#...#...#.....#.....#...#.#.#...#...#.......#.....#.........#.#.#...#...#...#.#...#.#...........#...#
#.###.#.#.#.#.#.#.###.#.#.#######.#.###.#.###.#.###.#########.###.#.#.#####.#.#####.#####.#.#########.#.#.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.#
#.#...#...#...#.#...#.#.#.....#...#...#.#...#.#...........#.....#.#.#.#.......#.........#.....#.....#...#.#.......#.#.#.#.....#.#.#.#.#...#.#
#.###.###.#####.###.#.#.#####.#.#####.#.###.#.#.#######.###.###.#.#.#.#########.#.#.###.#######.###.#.###.#########.###.#####.#.#.###.###.#.#
#...#...#.#.....#...#...#...#.#.....#...#...#.....#.......#.#.#.#...#.#.......#.#...#.#...........#.#...#.#.......#.....#.#.....#...#.#...#.#
#.#.#.###.#.#####.#####.#.#.#######.#.###.#######.#.#.###.#.#.#.###.#.#.#####.#.#####.###.#########.#####.#######.#######.#.#######.#.#.###.#
#.#.......#.....#.#.....#.#.....#.#.#.#...#.....#...#.#.#.#...#.....#...#.#...#...#...#.......#.....#...#.........#.......#...#...#.#.#...#.#
#.###.#####.###.#.###.###.###.#.#.#.#.#.###.###.###.#.#.#.###.###########.#.#.###.#.###.#####.#.###.#.#.#########.#.#####.###.#.#.#.#.###.#.#
#...#.....#.#...#...#.....#...#...#...#...#.#.#.#...#...#...................#...#.#.#...#.#...#...#.#.#.....#...#.#...#.....#...#.#.........#
###.#.###.###.#####.#.#####.#.###########.#.#.#.#.#####.###########.#.#####.###.#.#.#.###.#.#.###.#.#.#####.#.#.#.###.#.#.#######.#.#.#.#.###
#...#...#.....#...#.#.#.....#.#.......#...#.....#...#.......#...#...#.#.....#...#.#.#...#.#.#.#...#.#...#...#.#.#...#...#.......#.#.....#...#
#.###.#.#######.###.###.#######.#####.#.###.###.#.#.#.#####.#.#.#.#####.###.#.###.#.###.#.#.###.#######.#.###.#.###.#.#######.#.#.###.#####.#
#.#...#.#.....#.....#...#.......#.....#.#...#...#.#...#...#...#...#...#.#.#.#.....#.....#.#...#.........#.....#...#.#.....#...#...#.......#.#
#.#####.#####.#.#####.###.#.#.#####.###.#.###.###.#####.#.#########.#.#.#.#.#.#####.#####.#.#.#####.#.###########.#.#####.#.#.#####.#.###.#.#
#.....#.#...#.......#.#...#...#...#.#...#.#.#...#.#.....#...........#...#.#.#.#...#.#.......#...#...#.....#.....#...#...#.....#.....#...#.#.#
#####.#.#.#.#.#####.#.#.#######.#.#.###.#.#.###.#.#.###.#########.#######.#.#.#.#.#.#######.#.###.###.###.#.#.#.#######.#####.#.###.#.#.###.#
#.....#.#.#.#.......#.#.....#...#.#...#.#.#.#...#.#.#...#...#...#.#...#.....#.#.#...........#.#...#.......#.#.#.............#.#.#.#...#.#...#
#####.#.#.#.#.###.###.#####.#.#.#.###.#.#.#.#.###.#.#.###.#.#.#.###.#.#######.#############.#.#.###.#######.#.###########.###.#.#.#####.#.###
#...#.#...#.#.#...........#.....#.#...#.......#.#.#.#.#...#...#.#...#.......#...........#...#.#.....#...#.#.#...#.........#...#.....#...#...#
#.#.#.#####.#.#####.#.#######.###.#.#########.#.#.#.###.###.###.#.#########.###########.#####.#######.#.#.#.###.#######.###.###.#####.#####.#
#.#.#.....#.#.....#.#.#.....#.#...#...........#...#.......#.#...#.....#.......#.......#.........#.........#...#.......#.#...#...#...#.......#
#.#.#.###.#.###.#.###.#.###.###.#####.#####.###.#########.#.#.#######.#.###.###.#####.#########.###.#########.#.#.###.#.#.###.###.#.#.#.#.#.#
#.#.#.#.....#.........#.#.#...#.....#...#.....#.#.....#.#...#.......#.#.#...#...#...#.......#.#.....#.........#...#.#.#.#.#...#...#...#.#.#.#
#.#.#.#.#############.#.#.###.#####.#.#.#.###.#.#.#.#.#.###.#######.#.#.###.#.###.#.###.###.#.#.#.###.#########.#.#.#.#.#.#####.###.###.#.#.#
#.#.#.....#.........#.#.#...#.#.....#.#...#...#...#.#.#...........#...#.......#.#.#...#.#.....#.#.#.......#...#.....#.#.#...#...#...#...#...#
#.#.#.#.#.#.#######.#.#.#.###.#.#####.###########.#.#.###.###########.#####.###.#.#.#.#.#######.#.#.###.#.###.#######.#.###.#.#######.#####.#
#.#...#.#.#.#...#.#...#.#...#...#...#...#.......#.#.#...#.#.....#...#.........#.#.#...#.....#...#.......#.........#.....#.....#.....#...#...#
#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.###.###.#.###.#.#.###.#.#.#########.#.#.#.#.#####.#.###.###.###########.#.#####.#####.###.###.#.###
#.#...#...#.#.#...#.#.#.#.#.#.....#...#.....#.#...#...#.#.#.#.#...#.#.....#.#.#...#.#.....#...#.#.....#.........#.#.......#...#.#.......#.#.#
#.#.#.#####.#.#####.#.#.###.#.#############.#.#.#####.#.#.#.#.#####.#.###.#.#.#.###.###########.#######.#########.#########.#.#.#.#######.#.#
#.#.#.....#.#...#...#.#...#.#...#...#...#...#...#.....#.#.#.....#.#...#.#.....#...#.........#.....#...............#.#.......#.#.#.#...#...#.#
#.#.#.###.#.###.#.###.###.#.###.#.#.#.#.#####.###.#####.#######.#.#####.#.#.#.###.#########.#.###.#.#########.#.#.#.#.#######.#.###.#.#.###.#
#.#...#...#.#...#.#...#...#.....#...#.#.....#.#.#.#...#.#.....#...#...#.#.#.#...............#...#...#.......#.....#.#.#.......#.....#.#.#...#
#.###.#.###.#.#.#.#####.###.#######.#.#####.#.#.#.###.#.#.###.###.#.###.#.#.#.#########.#######.#####.#####.###.###.#.#.#.#####.#####.#.###.#
#.#.........#.#.#.....#.#.....#.....#.#.....#...#.....#.#.#...#.#.#...#.....#.#.......#.#.....#...#...#...#...#.....#.#...............#...#.#
#.###########.#.#####.#.###.#.#.#####.#.#.#######.#####.#.#.#.#.#.###.#####.#.#.#####.#.#.###.###.#.###.#.###.#####.#.#.#######.#########.#.#
#.#...#...#...#.#.....#...#.#...#...#.#.#.........#...#...#.#...#.....#.#...#.....#.#.#...#...#...#.#...#.........#.#...#.......#.........#.#
#.#.#.#.#.###.###.#######.#.###.#.#.#.#.###########.#.#####.#########.#.#.#######.#.#.###.#.###.###.###.#########.#.#.###.#####.#.#######.#.#
#.#.#.#.#...#...................#.#.#.#.........#.#.#...#...#.........#...#.......#.....#.#.....#.#...#.....#...#.#.......#.....#.#.....#...#
#.#.#.#.###.###########.#.#.#####.#.#.###.#####.#.#.###.#.#.#.#########.###.#.#########.#####.#.#.###.#######.#.#.#####.#####.#.###.###.###.#
#.#.#.#.#...#...#.....#...#.....#.#...#...#...#...#.#.#.....#...........#.#.#.......#.#...#...#...#.#.....#...#.#.............#.....#.#...#.#
#.#.#.#.#.###.#.###.#######.#####.#####.#.#.#.###.#.#.#####.#.###.#######.#.#######.#.###.#.#####.#.#####.#.###.#.###.#.#####.#.#####.###.###
#.#.#...#.....#...#.........#...#.#.....#...#...#.#.#.......#...#.#.....#...#.....#.#.......#...#...#...#...#...#...#.....#.#.#.....#...#...#
#.#.#########.###.#.#########.#.#.#.#.#.#.###.###.#.###########.#.#.###.#.###.###.#.###.#####.#.###.#.#.#####.#####.#####.#.#.#.###.#.#.###.#
#.#...#.......#...#.....#...#.#...#.#...#.........#.........#...#.#...#.#...#.#...#...#.#.....#.......#.#...#.#...#.#.....#...#.#.#...#.#...#
#.###.#.#.#.#.#.###.#####.#.#.#######.#######.#########.###.#.###.#.#.#.###.#.#.#####.###.###########.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.#.#
#...#.#.#.....#.#...#.....#...#.....#.......#.#...#.......#...#.......#...#.#.#.....#.........#.#...#.#...#.#.#.#.....#...#.#...#.......#.#.#
#.###.#.###.#.#.#.###.#########.#.#.#######.#.#.#.#.#.#########.###.#####.#.###.#.###########.#.#.#.###.###.#.#.#####.#####.###.#.#######.#.#
#.............#.#...#.......#...#.#.....#...#...#.#.#.........#.....#.#...#...#.#.#.........#...#.#...#...#.#.#.#.....#...#...#.#.#...#.....#
#.#####.###.#.#.###.###.#.#.###.#.#####.#.#######.#.###.###.###.###.#.#.#####.###.#.###.###.#####.###.#.#.#.#.#.#.#####.#####.#.#.#.#.#.###.#
#...#...#...#...#.#.#.#.#.#.....#...#...#.......#...#...#...#...#...#.#.....#.....#.....#.......#.#...#...#...#.#.#...#.....#...#.#.#.#...#.#
#####.#.###.#.###.#.#.#.#.#######.#.#.###.#.###.#####.###.###.###.###.#####.#####.#####.#####.#.#.#.###.#######.#.###.#.#.#####.#.#.#.###.#.#
#...#.#.......#.......#...#.......#.#...#.....#.........#.#...#.....#.....#.....#.....#...#...#...#.#.........#.#...#.#.#.........#.#.#...#.#
#.#.#.#.###.###.###########.#######.###.#.#############.#.#.#######.###.#.#####.#####.###.#.#######.###.#####.#.###.#.#.#######.###.#.#.###.#
#.#...........#.#.................#.#...#.#.........#...#.#.........#...#...#.#.....#...#.#.......#...#.#.....#...#.#.#.#.......#...#...#.#.#
#.#####.###.#.###.#######.#######.###.#####.###.#.#.#####.###.#######.#####.#.#####.#####.#.###.#.#.#.#.#.#####.###.#.#.###.###.#.#######.#.#
#.#.....#...#.......#...#.#...#...#...#.....#.#...#...#.....#.#.....#.....#.#.....#.#.....#...#.#.....#.#.#...#.....#.#.#...#...#.#...#.....#
#.#.###.#.#.###.#####.#.###.#.#.#.#.#####.###.#######.#.#####.#.###.#####.#.#.###.#.#.#######.#.###.#.###.#.###.###.#.#.#.###.###.#.#.#.#####
#...#...#.............#.....#...#.#.#.....#.......#...#.......#.#.#...#...#...#.#.#.#...#...#.#...#.#.....#.....#.....#.#...#...#...#.#.....#
#.###.#.#.#.#.###.###############.#.###.###.#######.###.#####.#.#.###.#.#######.#.#.###.#.###.###.#########.#####.#.###.###.#######.#.#####.#
#...#.#...#.#.#...#.....#.....#...#.....#.........#.#...#...#...#.....#.......#...#.#...#.#...#.#.......#...#.....#...#...#.#.....#.#.....#.#
###.#######.#.#.###.#####.#.###.#################.#.#.###.#.###.#.#######.###.#####.#.###.#.###.#######.#.###.#######.###.#.#.#.###.#.#.###.#
#.#.........#.#.#...#...#.#.#...#...#.......#...#.#.......#.#...#...#.....#...#...#.#.#.......#.......#.#...#...#...#...#.#...#...#.#.#.#...#
#.###########.#.#.#.#.#.#.#.#.###.#.#.###.#.#.#.#.#########.#.#####.#.###.#.#.#.#.#.#.#######.###.#.###.###.#.###.#.#.#.#.###.###.#.#.#.#.###
#...#.........#.#.#.#.#...#.......#.#.#.#.#...#.#.....#...#.#...#.#...#...#.#.#.............#...#.#...#...#.#.#...#...#.#...#...#.#.#.#...#.#
#.#.#.#.#######.###.#.#.###########.#.#.#.#####.#.#.#.#.#.#.###.#.#####.###.###.###########.###.#####.###.#.#.#.###.#.#####.#####.#.###.#.#.#
#.....#.......#...#...........#.....#...#.#.....#...#.#.#.#.....#.#.....#...................#.#...#...#.#...#.#.....#.#...#.#.....#...#...#.#
#.#.###.#####.###.#####.#.#.#.#####.###.#.#.#########.#.#.#######.#.#####.###################.###.#.#.#.#####.#####.#.#.#.#.#.#######.###.#.#
#...#.........#.#...#.....#.#.....#.#...#.#.#...#.....#.#.......#...#.........#.......#.........#.#.#.#...#...#.#...#.#.#...#.......#...#...#
###.#.#.#####.#.###.#####.#.#####.#.###.#.#.#.#.#.###.#.###.###.#.#############.#####.#.#.#.#####.#.#.#.###.###.#.###.#.#########.#.###.#.#.#
#.................#...#...#.#.....#...#.#.#.#.#...#.#.#...#...#.#.#...........#.#.....#.#.........#.#.#...#...#.#...#.#.....#.....#.......#.#
#.#.###.###.#####.###.#####.#.#######.###.#.#.#####.#.###.###.#.#.###.#######.#.###.###.###########.#.#.#.###.#.###.#######.#.#.#######.#.#.#
#.#.....#...#...#...#...#...#.......#.....#.#.#.......#...#.#.#.......#.......#...#...#...#.....#...#.#.#...#.#...#.....#.#.#.#.#.....#.#.#.#
#.#.###.#.#.#.#.#.#####.#.#######.#.#######.#.###.#####.###.#.#########.#########.###.###.#.###.###.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#.#
#.#...#...#...#.#.#.....#...#...#.#.#.....#.#...#...#.......#.........#...#.....#.#.#...#...#.#...#.#...#.#.#...#...#.#...#...#.#...#.#.#.#.#
#.#.#.#.###.###.#.#.#######.#.#.###.#.#####.#.#.#####.###.#########.#.###.#.###.#.#.###.#####.###.#.###.#.#.###.#.#.#.#########.###.#.#.#.#.#
#...#.....#.#.....#.#.......#.#.....#.....#.#.#.......#...#.......#.#...#.#...#...#...#...#...#.#.#.#.#.#.#.....#.#.#...#...#...#.#.#.#.#.#.#
#.#####.#.#.#.###.#.#.#######.#######.###.#.#######.###.#.#.#####.#####.#.###.#####.#.###.#.#.#.#.#.#.#.#.#######.#.###.#.#.#.###.#.#.###.#.#
#.#.....#...#.....#...#...#...#.....#.#...#.#.....#.#...#...#...........#.....#.#...#.#...#.#...#...#.#.#.....#...#...#...#...#...#.#.....#.#
#.#.#.#####.#####.#####.#.#.###.###.#.#.#.#.#.###.###.#######.#################.#.#.###.###.###.#####.#.#######.#####.#.#########.#.#####.#.#
#...#...........#.#...#.#.#...#.#...#.#.#.#...#.#.#...#.......#...#...........#...#...#...#...#.....#.#.........#.....#...#.......#.....#...#
#.#########.#.###.#.###.#.###.#.#####.#.#######.#.#.###.#######.#.#.#######.###.###.#.###.#.#.#####.#.###########.#######.#.###########.#.#.#
#.....#.......#...#.....#...#.#.......#.#.......#.#...#.#...#...#...#.....#...#.....#.#...#.#...#.........#.#.....#.#.......#.....#...#.#...#
#######.#.#.###.###########.#.#.#######.#.###.#.#.###.#.#.#.#.#######.###.###.#####.#.#.###.###.#########.#.#.#####.#.#####.#.###.#.#.#.###.#
#.......#.#.....#.......#.....#.#.....#...#...#.....#.#.#.#...#.#.....#.....#.#.....#...#...#.#...#...#.....#.....#.....#.......#...#.#.#...#
#.#.#####.#.#####.#####.#.###.#.###.#####.#.#######.#.#.#.#####.#.#####.###.#.#.#.#.#.###.#.#.###.#.#.###.#######.#####.#############.#.#.###
#.#.#.....................#...#...#.......#...........#.#...#.....#.....#.#.#...#.#.#.........#.#...#...#.#.....#.....#...............#.#.#.#
#.#.#.###.#.#.#.###.#.#####.#####.#####.#.#########.#####.#.###.#.#.#####.#.#####.#.#.#######.#.#######.###.#.#.#####.#############.###.#.#.#
#.#.#.#.#...#...#...#.........................#...................#.#...#.#.#.....#.........#...#.#.....#...#.#...#...#...........#.#...#.#.#
#.###.#.#.#######.###.###.#.#.#.#####.#.###.#.#.#.#.#.###.###.###.#.#.#.#.#.#.###.###.#####.###.#.#.#####.###.#.###.#########.###.#.#.###.#.#
#.#...#...........#.#.#...#.#.#.#...#.........................#...#.....#...............................#...#.#.#...#.......#...#...#.#.#...#
#.#.###.#.###.#####.#.#.#####.#.#.###.###.#.#####.#####.#.#######.#####.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.###.#####.###.#####.#.###.#
#.............................#.#...#.....#...#...#.....#...............#.#.#.#...#.....#.#...#.........#.#...#.#...#...#.#...#.#.....#.....#
#.#######.#####.###.###########.#.#.#.#######.#.###.#####.###.#.#.#######.#.#.###.#.#.###.###.###.#####.#.#.#######.###.#.###.#.#.#####.#####
#.#.......#.....#...#.#...#.....#.#...#.....#.#...#.........#.#.........#...#...#...#...#.#.#.#.#.....#.#.#.........#.......................#
#.###.###.#.#####.###.#.#.#.#########.#.###.#.###.###.#.###.###########.#.#####.#####.#.#.#.#.#.#####.#.#.###########.###.#.#########.###.#.#
#...........................#.......#.........#.#...#.#.#...#...#.....#.#.#...#.....#.#.....#.#.#.....#.#...#.....#...#.#...#...#.....#.#.#.#
###.#.#.#.#####.###.#.#.#####.#####.#####.#.#.#.#.###.#.#.#.#.#.#.###.#.#.#.#.#####.#########.#.#.#####.###.#.###.#.###.#.###.#.#.#####.#.#.#
#S....#.......#.......#...........#.......#.....#.......#.....#...#.....#...#.....#...........#.......#.......#.....#.........#...#.........#
#############################################################################################################################################`
