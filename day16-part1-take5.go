//go:build ignore

package main

import (
	"container/heap"
	"fmt"
	"strings"
)

var globalMinCost = -1

type costOk struct {
	cost int
	ok   bool
}

type visitedNode struct {
	x, y int
	dir  int
}

type pqNode struct {
	cost int
	x, y int
	dir  int
}

type pq []*pqNode

func (q pq) Less(i, j int) bool {
	return q[i].cost < q[j].cost
}

func (q pq) Swap(i, j int) {
	q[i], q[j] = q[j], q[i]
}

func (q pq) Len() int {
	return len(q)
}

func (q *pq) Push(x any) {
	*q = append(*q, x.(*pqNode))
}

func (q *pq) Pop() any {
	old := *q
	n := len(old)
	x := old[n-1]
	*q = old[:n-1]
	return x
}

var _ heap.Interface = (*pq)(nil)

// cache visited nodes cost
var visitedNodes = make(map[visitedNode]costOk)

func main() {
	m, sx, sy, ex, ey := parseMap(input)

	var queue pq
	visitedNodes := make(map[visitedNode]bool)
	heap.Init(&queue)
	heap.Push(&queue, &pqNode{0, sx, sy, 1})
	for len(queue) > 0 {
		n := heap.Pop(&queue).(*pqNode)
		if n.x == ex && n.y == ey {
			fmt.Println("cost", n.cost)
			break
		}
		if visitedNodes[visitedNode{n.x, n.y, n.dir}] {
			continue
		}
		visitedNodes[visitedNode{n.x, n.y, n.dir}] = true
		var nx, ny int
		switch n.dir {
		case 0:
			nx, ny = n.x, n.y-1
		case 1:
			nx, ny = n.x+1, n.y
		case 2:
			nx, ny = n.x, n.y+1
		case 3:
			nx, ny = n.x-1, n.y
		}
		if 0 <= ny && ny < len(m) && 0 <= nx && nx < len(m[ny]) && m[ny][nx] != '#' {
			heap.Push(&queue, &pqNode{n.cost + 1, nx, ny, n.dir})
		}
		switch n.dir {
		case 0:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 1:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
		case 2:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 1})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 3})
		case 3:
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 2})
			heap.Push(&queue, &pqNode{n.cost + 1000, n.x, n.y, 0})
		}

	}
}

func cloneVisitedPath(m map[int]map[int]bool) map[int]map[int]bool {
	cloned := make(map[int]map[int]bool)
	for k, v := range m {
		cloned[k] = make(map[int]bool)
		for kk, vv := range v {
			cloned[k][kk] = vv
		}
	}

	return cloned
}

func cloneTurnedPath(m map[int]bool) map[int]bool {
	cloned := make(map[int]bool)
	for k, v := range m {
		cloned[k] = v
	}
	return cloned
}

func clonePaths(m []points) []points {
	var cloned []points
	for _, p := range m {
		cloned = append(cloned, p)
	}
	return cloned
}

type points struct {
	x, y int
}

func findPath(m [][]rune,
	sx, sy,
	ex, ey int,
	currentDir int,
	cost int,
	visitedPath map[int]map[int]bool,
	turnedPath map[int]bool,
) (int, bool) {
	if globalMinCost != -1 && cost > globalMinCost {
		fmt.Println("cost", globalMinCost, cost)
		return 0, false
	}

	if visitedPath[sy] == nil {
		visitedPath[sy] = make(map[int]bool)
	}
	visitedPath[sy][sx] = true

	if sx == ex && sy == ey {
		if globalMinCost == -1 || cost < globalMinCost {
			globalMinCost = cost
			fmt.Println("cost-done", cost)
		}
		return cost, true
	}

	var costs []costOk

	// up
	if currentDir == 0 && m[sy-1][sx] != '#' && !visitedPath[sy-1][sx] {
		if cc, ok := visitedNodes[visitedNode{sx, sy - 1, 0}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok := findPath(m, sx, sy-1, ex, ey, 0, cost+1, clonedVisitedPath, newTurnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy - 1, 0}] = costOk{c, ok}
			}
		}
	}

	// right
	if currentDir == 1 && m[sy][sx+1] != '#' && !visitedPath[sy][sx+1] {
		if cc, ok := visitedNodes[visitedNode{sx + 1, sy, 1}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok := findPath(m, sx+1, sy, ex, ey, 1, cost+1, clonedVisitedPath, newTurnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx + 1, sy, 1}] = costOk{c, ok}
			}
		}
	}

	// down
	if currentDir == 2 && m[sy+1][sx] != '#' && !visitedPath[sy+1][sx] {
		if cc, ok := visitedNodes[visitedNode{sx, sy + 1, 2}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok := findPath(m, sx, sy+1, ex, ey, 2, cost+1, clonedVisitedPath, newTurnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy + 1, 2}] = costOk{c, ok}
			}
		}
	}

	// left
	if currentDir == 3 && m[sy][sx-1] != '#' && !visitedPath[sy][sx-1] {
		if cc, ok := visitedNodes[visitedNode{sx - 1, sy, 3}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok := findPath(m, sx-1, sy, ex, ey, 3, cost+1, clonedVisitedPath, newTurnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx - 1, sy, 3}] = costOk{c, ok}
			}
		}
	}

	// turn to up
	if (currentDir == 1 || currentDir == 3) && m[sy-1][sx] != '#' && !visitedPath[sy-1][sx] && !turnedPath[0] {
		if cc, ok := visitedNodes[visitedNode{sx, sy, 0}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			turnedPath[0] = true
			c, ok := findPath(m, sx, sy, ex, ey, 0, cost+1000, clonedVisitedPath, turnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy, 0}] = costOk{c, ok}
			}
		}
	}

	// turn to right
	if (currentDir == 0 || currentDir == 2) && m[sy][sx+1] != '#' && !visitedPath[sy][sx+1] && !turnedPath[1] {
		if cc, ok := visitedNodes[visitedNode{sx, sy, 1}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			turnedPath[1] = true
			c, ok := findPath(m, sx, sy, ex, ey, 1, cost+1000, clonedVisitedPath, turnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy, 1}] = costOk{c, ok}
			}
		}
	}

	// turn to down
	if (currentDir == 1 || currentDir == 3) && m[sy+1][sx] != '#' && !visitedPath[sy+1][sx] && !turnedPath[2] {
		if cc, ok := visitedNodes[visitedNode{sx, sy, 2}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			turnedPath[2] = true
			c, ok := findPath(m, sx, sy, ex, ey, 2, cost+1000, clonedVisitedPath, turnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy, 2}] = costOk{c, ok}
			}
		}
	}

	// turn to left
	if (currentDir == 0 || currentDir == 2) && m[sy][sx-1] != '#' && !visitedPath[sy][sx-1] && !turnedPath[3] {
		if cc, ok := visitedNodes[visitedNode{sx, sy, 3}]; ok {
			costs = append(costs, cc)
		} else {
			clonedVisitedPath := cloneVisitedPath(visitedPath)
			turnedPath[3] = true
			c, ok := findPath(m, sx, sy, ex, ey, 3, cost+1000, clonedVisitedPath, turnedPath)
			costs = append(costs, costOk{c, ok})
			if ok {
				visitedNodes[visitedNode{sx, sy, 3}] = costOk{c, ok}
			}
		}
	}

	if len(costs) == 0 {
		return 0, false
	}

	var minCost costOk
	for _, c := range costs {
		if !minCost.ok && c.ok {
			minCost = c
			continue
		}

		if c.cost < minCost.cost && c.ok {
			minCost = c
		}
	}

	if minCost.ok && minCost.cost < globalMinCost {
		globalMinCost = minCost.cost
		return minCost.cost, minCost.ok
	}

	return 0, false
}

func parseMap(input string) ([][]rune, int, int, int, int) {
	var m [][]rune
	var sx, sy, ex, ey int
	for y, l := range strings.Split(input, "\n") {
		m = append(m, []rune(l))
		for x, r := range []rune(l) {
			if r == 'S' {
				sx, sy = x, y
			}
			if r == 'E' {
				ex, ey = x, y
			}
		}
	}
	return m, sx, sy, ex, ey
}

var ex1 = `###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############`

var ex2 = `#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################`

var input = `#############################################################################################################################################
#.#...............#.........#.....#...........#.............#.............#.#.......#.#.........#...........#.......#...........#.........#E#
#.#.#.###########.#.#.#####.#.#.#.###.#####.#.#.#########.#.#.###.###.###.#.#.###.#.#.#.#.###.#.#.#######.#.#####.#.#.#.#.#.###.#.#.#####.#.#
#.#.#.....#.....#...#.....#.#...............#.#...#...#.....#.....#...#.#.#.#.#...#...........#.#.#.....#.#.#...#.#.#.#.#...#...#.#.#...#...#
#.#.#####.#.#######.#.###.#.#.#.#######.###.#.#.#.#.#.#.###########.###.#.#.#.#.###.#####.###.###.#.###.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#####.#
#...#...#.#.....#...#...#.#.....#.....#.#.#...#.#.#.#.#.#.....#.....#.......#.#...#.#...#...#.....#...#.#.#...#.#.#...#.#.#.#.#...#.#.......#
#.###.#.#.#.###.#.#.#####.###.#####.#.#.#.#.###.#.#.#.#.###.#.#.#########.###.###.#.#.#.###.###########.#.#####.#.#######.#.#.#####.#.#######
#...#.#.#.#...#.#.........#.#.......#.#.#.......#.#.#.......................#.#.#.#.#.#...#...#.......#.#.#.....#.......#.#.#...#...#.#.....#
###.#.#.#.###.#.###.#######.#.#.###.###.#.#.#####.#####.#.###.#.#########.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.#####.#####.#.#.###.#.###.#.###.#
#...#.#.#.#.#.#.....#.......#.#.#...#...#.#.....#.....#...#.#.#...........#.....#.#...#.#.#.....#.......#.#.#...#.....#...#.#.#.#...#...#.#.#
#.###.#.#.#.#.###.#.#.#.#####.#.#####.###.#.###.#####.#####.#.###.#######.#######.#####.#.#.#############.#.###.#####.#####.#.#.###.###.#.#.#
#.#...#...#.........................#...#.#...#.#.....#.....#...#.#...........................#...#.................#...#...#.#...#.......#.#
#.#.###.#######.#.#.#######.#.#####.###.###.#.#.#.#####.#######.###.#.###.#.###.#.#.###.#######.#.#.###.#.###.###.#.###.#.#.#.###.#########.#
#.#.#...#.....#.#.........#.....#.#...#...#...#...#...#.......#...#.#.......#.#.#.#...#.........#...#.....#.#.............#.......#.....#...#
#.#.#####.###.#.###.#####.#.#.#.#.###.###.#.#########.#.#####.###.#.#####.###.#.#.###.#.#############.#####.###.#.###.#.#.###.#####.###.#.###
#.........#.#.#...#...#...#.........#...#...#.#.......#.....#...#.#.#...#...#...#.......#.........#...#...#.....#...#...#...#...#...#...#...#
#.#########.#.###.###.#.#####.#######.#.#####.#.###.#######.#.###.#.#.###.#.#.#######.#.#.#######.#####.#.###.###########.#.###.#.###.###.#.#
#.#.#.....#.#.#.......#...#.........#.#.........#...#.....#.#...#...#...#.#.#.#.....#.#.........#.......#...#...........#.#.#.....#.#.#.#.#.#
#.#.#.#.#.#.#.#.###########.#####.#.#.###########.###.###.#.###.#####.#.#.#.#.#.#.#.#.###########.#########.###########.#.#.#.#####.#.#.#.#.#
#.#...#.#...#.#.#.........#.#.....#.#...#.....#...#.....#.#...#...#...#.#.#...#.#.#.#...#.......#.#...#...#.#...#.....#.#.#.#.......#.#...#.#
#.#####.###.#.###.#######.#.#.###.#.#####.###.#.#.#.#####.###.###.#.###.#.#######.#.#####.#####.###.#.#.#.#.#.#.#.#.#.#.###.#.###.###.#####.#
#.......#.#.#...........#...#.#...#.....#...#...#.#...#...#...#.#.#...#...#.....#.#.#.....#.....#...#.#...#.#.#...#...#.#...#...#...#.....#.#
#########.#.#############.###.#######.#.#.#.#########.#.###.###.#.###.#######.#.#.#.#.#####.#.###.###.#.#.#.#.#####.#.#.#.#######.#.#####.#.#
#.#.....#...#...........#.....#.....#.#.#.#.........#.#.....#...#.#...#.....#.#...#.#.....#...#.#...#.#.#...#.#.....#.#.#.......#.#.....#...#
#.#.#.###.###.#.#######.#######.###.###.#.#.#.#####.#.#######.#.#.#.###.###.#.#####.#.#.###.###.#.#.#.#.#####.#.#######.#######.#.###.#####.#
#...#...#.....#.....#.#.........#.#.#...#.....#...#.........#.#.#.......#.#...#...#.#.#...#.#.....#.#...#...#.#.......#.......#.#.#.#.......#
#.#####.#.###.#####.#.###########.#.#.###.#####.#.#########.#.#.#######.#.#####.#.#.#.###.#.#.#####.###.#.#.#.#######.#######.#.#.#.#########
#.#...#.#.......#...#.....#...#.......#.....#...#...#...#...#.#.........#.#.....#...#...#.#.#.....#...#...#.....#...#...#...#...#.........#.#
#.#.#.#.#.#####.#.#######.#.#.#.#############.###.#.###.#.#####.###.#####.#.###########.#.#.#########.#.#######.#.#.###.#.#.#############.#.#
#.#.#...#.....#.#...#...#...#...#.....#.......#...#...#.......#.#.#.#.#...#.#.......#...#.#...#...#...#.#.....#.#.#...#...#.......#.....#...#
###.#####.###.#.###.#.#.#.#######.###.#.#######.#####.#######.#.#.#.#.#.#.#.#.#####.#.###.###.#.#.#.#####.###.###.###.#####.#####.#.#.#####.#
#...#.....#.#...#.#...#.#...#.....#.#...#.......#...#...#...#.#.....#.......#...#...#...#.....#.#.#.#.......#...#...#.....#.........#.......#
#.#.#.###.#.#####.#####.###.#.#####.#######.#####.#.#.#.#.#.#.#####.#.#########.#.###.#.###.#.#.#.#.#.#####.#.#.###.#####.#######.#.#.#######
#.#.#.....#.#.........#.#.#.#...#.#.....#...#.....#.#.#.#.#.#.......#.#.........#...#.#...#.....#.#...#...#...#.........#.......#.#.........#
#.#######.#.#.#######.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.###.#####.###.#######.#####.#####.#######.#####.#.###############.#####.#.#######.#.#
#.#.......#...#...#.....#...#...#...#.#...#.#...#.#.#.#...#.........#.......#...#.#.......#.....#.......#...........#.......#...#.........#.#
#.#.#.###.#.#####.#.#.#.#.###.#######.#####.###.#.#.#####.#####.#.#.#######.###.#.#########.#######################.#.#.###.#.###.#######.#.#
#...#...#.#.......#.#.#.#...#.......#...#...#...#.#.#...#.....#.#.#.......#...#.................#.........#.......#...#...#.#...#.......#.#.#
#.###.#.#.#######.#.###.###########.#.#.#.###.###.#.#.#.#.###.#.#.#.#####.###.#.#.###########.#.#.###.###.#.#####.#######.###.#.###.###.#.#.#
#.....#.#.........#...#.....#.....#.#.#.#.#...#...#...#.#.#...#...#.....#.#.#...#.#...........#...#...#.....#.#.........#.....#...#...#.....#
#####.#.#.#########.#.#####.#.###.#.#.#.###.###.#.#####.###.#####.#####.#.#.#######.#########.#####.###.#####.#.#####.#####.#.###.#.#####.###
#.....#.#...#.#...#.......#.....#.#.#.#.#...#...#.....#.....#...#.#.#...#...#.......#.....#.........#.#.#...#...#...#.#...#.#...........#...#
#.###.#.#.#.#.#.#.###.#.#.#######.#.###.#.###.#.###.#########.###.#.#.#####.#.#####.#####.#.#########.#.#.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.#
#.#...#...#...#.#...#.#.#.....#...#...#.#...#.#...........#.....#.#.#.#.......#.........#.....#.....#...#.#.......#.#.#.#.....#.#.#.#.#...#.#
#.###.###.#####.###.#.#.#####.#.#####.#.###.#.#.#######.###.###.#.#.#.#########.#.#.###.#######.###.#.###.#########.###.#####.#.#.###.###.#.#
#...#...#.#.....#...#...#...#.#.....#...#...#.....#.......#.#.#.#...#.#.......#.#...#.#...........#.#...#.#.......#.....#.#.....#...#.#...#.#
#.#.#.###.#.#####.#####.#.#.#######.#.###.#######.#.#.###.#.#.#.###.#.#.#####.#.#####.###.#########.#####.#######.#######.#.#######.#.#.###.#
#.#.......#.....#.#.....#.#.....#.#.#.#...#.....#...#.#.#.#...#.....#...#.#...#...#...#.......#.....#...#.........#.......#...#...#.#.#...#.#
#.###.#####.###.#.###.###.###.#.#.#.#.#.###.###.###.#.#.#.###.###########.#.#.###.#.###.#####.#.###.#.#.#########.#.#####.###.#.#.#.#.###.#.#
#...#.....#.#...#...#.....#...#...#...#...#.#.#.#...#...#...................#...#.#.#...#.#...#...#.#.#.....#...#.#...#.....#...#.#.........#
###.#.###.###.#####.#.#####.#.###########.#.#.#.#.#####.###########.#.#####.###.#.#.#.###.#.#.###.#.#.#####.#.#.#.###.#.#.#######.#.#.#.#.###
#...#...#.....#...#.#.#.....#.#.......#...#.....#...#.......#...#...#.#.....#...#.#.#...#.#.#.#...#.#...#...#.#.#...#...#.......#.#.....#...#
#.###.#.#######.###.###.#######.#####.#.###.###.#.#.#.#####.#.#.#.#####.###.#.###.#.###.#.#.###.#######.#.###.#.###.#.#######.#.#.###.#####.#
#.#...#.#.....#.....#...#.......#.....#.#...#...#.#...#...#...#...#...#.#.#.#.....#.....#.#...#.........#.....#...#.#.....#...#...#.......#.#
#.#####.#####.#.#####.###.#.#.#####.###.#.###.###.#####.#.#########.#.#.#.#.#.#####.#####.#.#.#####.#.###########.#.#####.#.#.#####.#.###.#.#
#.....#.#...#.......#.#...#...#...#.#...#.#.#...#.#.....#...........#...#.#.#.#...#.#.......#...#...#.....#.....#...#...#.....#.....#...#.#.#
#####.#.#.#.#.#####.#.#.#######.#.#.###.#.#.###.#.#.###.#########.#######.#.#.#.#.#.#######.#.###.###.###.#.#.#.#######.#####.#.###.#.#.###.#
#.....#.#.#.#.......#.#.....#...#.#...#.#.#.#...#.#.#...#...#...#.#...#.....#.#.#...........#.#...#.......#.#.#.............#.#.#.#...#.#...#
#####.#.#.#.#.###.###.#####.#.#.#.###.#.#.#.#.###.#.#.###.#.#.#.###.#.#######.#############.#.#.###.#######.#.###########.###.#.#.#####.#.###
#...#.#...#.#.#...........#.....#.#...#.......#.#.#.#.#...#...#.#...#.......#...........#...#.#.....#...#.#.#...#.........#...#.....#...#...#
#.#.#.#####.#.#####.#.#######.###.#.#########.#.#.#.###.###.###.#.#########.###########.#####.#######.#.#.#.###.#######.###.###.#####.#####.#
#.#.#.....#.#.....#.#.#.....#.#...#...........#...#.......#.#...#.....#.......#.......#.........#.........#...#.......#.#...#...#...#.......#
#.#.#.###.#.###.#.###.#.###.###.#####.#####.###.#########.#.#.#######.#.###.###.#####.#########.###.#########.#.#.###.#.#.###.###.#.#.#.#.#.#
#.#.#.#.....#.........#.#.#...#.....#...#.....#.#.....#.#...#.......#.#.#...#...#...#.......#.#.....#.........#...#.#.#.#.#...#...#...#.#.#.#
#.#.#.#.#############.#.#.###.#####.#.#.#.###.#.#.#.#.#.###.#######.#.#.###.#.###.#.###.###.#.#.#.###.#########.#.#.#.#.#.#####.###.###.#.#.#
#.#.#.....#.........#.#.#...#.#.....#.#...#...#...#.#.#...........#...#.......#.#.#...#.#.....#.#.#.......#...#.....#.#.#...#...#...#...#...#
#.#.#.#.#.#.#######.#.#.#.###.#.#####.###########.#.#.###.###########.#####.###.#.#.#.#.#######.#.#.###.#.###.#######.#.###.#.#######.#####.#
#.#...#.#.#.#...#.#...#.#...#...#...#...#.......#.#.#...#.#.....#...#.........#.#.#...#.....#...#.......#.........#.....#.....#.....#...#...#
#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.###.###.#.###.#.#.###.#.#.#########.#.#.#.#.#####.#.###.###.###########.#.#####.#####.###.###.#.###
#.#...#...#.#.#...#.#.#.#.#.#.....#...#.....#.#...#...#.#.#.#.#...#.#.....#.#.#...#.#.....#...#.#.....#.........#.#.......#...#.#.......#.#.#
#.#.#.#####.#.#####.#.#.###.#.#############.#.#.#####.#.#.#.#.#####.#.###.#.#.#.###.###########.#######.#########.#########.#.#.#.#######.#.#
#.#.#.....#.#...#...#.#...#.#...#...#...#...#...#.....#.#.#.....#.#...#.#.....#...#.........#.....#...............#.#.......#.#.#.#...#...#.#
#.#.#.###.#.###.#.###.###.#.###.#.#.#.#.#####.###.#####.#######.#.#####.#.#.#.###.#########.#.###.#.#########.#.#.#.#.#######.#.###.#.#.###.#
#.#...#...#.#...#.#...#...#.....#...#.#.....#.#.#.#...#.#.....#...#...#.#.#.#...............#...#...#.......#.....#.#.#.......#.....#.#.#...#
#.###.#.###.#.#.#.#####.###.#######.#.#####.#.#.#.###.#.#.###.###.#.###.#.#.#.#########.#######.#####.#####.###.###.#.#.#.#####.#####.#.###.#
#.#.........#.#.#.....#.#.....#.....#.#.....#...#.....#.#.#...#.#.#...#.....#.#.......#.#.....#...#...#...#...#.....#.#...............#...#.#
#.###########.#.#####.#.###.#.#.#####.#.#.#######.#####.#.#.#.#.#.###.#####.#.#.#####.#.#.###.###.#.###.#.###.#####.#.#.#######.#########.#.#
#.#...#...#...#.#.....#...#.#...#...#.#.#.........#...#...#.#...#.....#.#...#.....#.#.#...#...#...#.#...#.........#.#...#.......#.........#.#
#.#.#.#.#.###.###.#######.#.###.#.#.#.#.###########.#.#####.#########.#.#.#######.#.#.###.#.###.###.###.#########.#.#.###.#####.#.#######.#.#
#.#.#.#.#...#...................#.#.#.#.........#.#.#...#...#.........#...#.......#.....#.#.....#.#...#.....#...#.#.......#.....#.#.....#...#
#.#.#.#.###.###########.#.#.#####.#.#.###.#####.#.#.###.#.#.#.#########.###.#.#########.#####.#.#.###.#######.#.#.#####.#####.#.###.###.###.#
#.#.#.#.#...#...#.....#...#.....#.#...#...#...#...#.#.#.....#...........#.#.#.......#.#...#...#...#.#.....#...#.#.............#.....#.#...#.#
#.#.#.#.#.###.#.###.#######.#####.#####.#.#.#.###.#.#.#####.#.###.#######.#.#######.#.###.#.#####.#.#####.#.###.#.###.#.#####.#.#####.###.###
#.#.#...#.....#...#.........#...#.#.....#...#...#.#.#.......#...#.#.....#...#.....#.#.......#...#...#...#...#...#...#.....#.#.#.....#...#...#
#.#.#########.###.#.#########.#.#.#.#.#.#.###.###.#.###########.#.#.###.#.###.###.#.###.#####.#.###.#.#.#####.#####.#####.#.#.#.###.#.#.###.#
#.#...#.......#...#.....#...#.#...#.#...#.........#.........#...#.#...#.#...#.#...#...#.#.....#.......#.#...#.#...#.#.....#...#.#.#...#.#...#
#.###.#.#.#.#.#.###.#####.#.#.#######.#######.#########.###.#.###.#.#.#.###.#.#.#####.###.###########.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.#.#
#...#.#.#.....#.#...#.....#...#.....#.......#.#...#.......#...#.......#...#.#.#.....#.........#.#...#.#...#.#.#.#.....#...#.#...#.......#.#.#
#.###.#.###.#.#.#.###.#########.#.#.#######.#.#.#.#.#.#########.###.#####.#.###.#.###########.#.#.#.###.###.#.#.#####.#####.###.#.#######.#.#
#.............#.#...#.......#...#.#.....#...#...#.#.#.........#.....#.#...#...#.#.#.........#...#.#...#...#.#.#.#.....#...#...#.#.#...#.....#
#.#####.###.#.#.###.###.#.#.###.#.#####.#.#######.#.###.###.###.###.#.#.#####.###.#.###.###.#####.###.#.#.#.#.#.#.#####.#####.#.#.#.#.#.###.#
#...#...#...#...#.#.#.#.#.#.....#...#...#.......#...#...#...#...#...#.#.....#.....#.....#.......#.#...#...#...#.#.#...#.....#...#.#.#.#...#.#
#####.#.###.#.###.#.#.#.#.#######.#.#.###.#.###.#####.###.###.###.###.#####.#####.#####.#####.#.#.#.###.#######.#.###.#.#.#####.#.#.#.###.#.#
#...#.#.......#.......#...#.......#.#...#.....#.........#.#...#.....#.....#.....#.....#...#...#...#.#.........#.#...#.#.#.........#.#.#...#.#
#.#.#.#.###.###.###########.#######.###.#.#############.#.#.#######.###.#.#####.#####.###.#.#######.###.#####.#.###.#.#.#######.###.#.#.###.#
#.#...........#.#.................#.#...#.#.........#...#.#.........#...#...#.#.....#...#.#.......#...#.#.....#...#.#.#.#.......#...#...#.#.#
#.#####.###.#.###.#######.#######.###.#####.###.#.#.#####.###.#######.#####.#.#####.#####.#.###.#.#.#.#.#.#####.###.#.#.###.###.#.#######.#.#
#.#.....#...#.......#...#.#...#...#...#.....#.#...#...#.....#.#.....#.....#.#.....#.#.....#...#.#.....#.#.#...#.....#.#.#...#...#.#...#.....#
#.#.###.#.#.###.#####.#.###.#.#.#.#.#####.###.#######.#.#####.#.###.#####.#.#.###.#.#.#######.#.###.#.###.#.###.###.#.#.#.###.###.#.#.#.#####
#...#...#.............#.....#...#.#.#.....#.......#...#.......#.#.#...#...#...#.#.#.#...#...#.#...#.#.....#.....#.....#.#...#...#...#.#.....#
#.###.#.#.#.#.###.###############.#.###.###.#######.###.#####.#.#.###.#.#######.#.#.###.#.###.###.#########.#####.#.###.###.#######.#.#####.#
#...#.#...#.#.#...#.....#.....#...#.....#.........#.#...#...#...#.....#.......#...#.#...#.#...#.#.......#...#.....#...#...#.#.....#.#.....#.#
###.#######.#.#.###.#####.#.###.#################.#.#.###.#.###.#.#######.###.#####.#.###.#.###.#######.#.###.#######.###.#.#.#.###.#.#.###.#
#.#.........#.#.#...#...#.#.#...#...#.......#...#.#.......#.#...#...#.....#...#...#.#.#.......#.......#.#...#...#...#...#.#...#...#.#.#.#...#
#.###########.#.#.#.#.#.#.#.#.###.#.#.###.#.#.#.#.#########.#.#####.#.###.#.#.#.#.#.#.#######.###.#.###.###.#.###.#.#.#.#.###.###.#.#.#.#.###
#...#.........#.#.#.#.#...#.......#.#.#.#.#...#.#.....#...#.#...#.#...#...#.#.#.............#...#.#...#...#.#.#...#...#.#...#...#.#.#.#...#.#
#.#.#.#.#######.###.#.#.###########.#.#.#.#####.#.#.#.#.#.#.###.#.#####.###.###.###########.###.#####.###.#.#.#.###.#.#####.#####.#.###.#.#.#
#.....#.......#...#...........#.....#...#.#.....#...#.#.#.#.....#.#.....#...................#.#...#...#.#...#.#.....#.#...#.#.....#...#...#.#
#.#.###.#####.###.#####.#.#.#.#####.###.#.#.#########.#.#.#######.#.#####.###################.###.#.#.#.#####.#####.#.#.#.#.#.#######.###.#.#
#...#.........#.#...#.....#.#.....#.#...#.#.#...#.....#.#.......#...#.........#.......#.........#.#.#.#...#...#.#...#.#.#...#.......#...#...#
###.#.#.#####.#.###.#####.#.#####.#.###.#.#.#.#.#.###.#.###.###.#.#############.#####.#.#.#.#####.#.#.#.###.###.#.###.#.#########.#.###.#.#.#
#.................#...#...#.#.....#...#.#.#.#.#...#.#.#...#...#.#.#...........#.#.....#.#.........#.#.#...#...#.#...#.#.....#.....#.......#.#
#.#.###.###.#####.###.#####.#.#######.###.#.#.#####.#.###.###.#.#.###.#######.#.###.###.###########.#.#.#.###.#.###.#######.#.#.#######.#.#.#
#.#.....#...#...#...#...#...#.......#.....#.#.#.......#...#.#.#.......#.......#...#...#...#.....#...#.#.#...#.#...#.....#.#.#.#.#.....#.#.#.#
#.#.###.#.#.#.#.#.#####.#.#######.#.#######.#.###.#####.###.#.#########.#########.###.###.#.###.###.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#.#
#.#...#...#...#.#.#.....#...#...#.#.#.....#.#...#...#.......#.........#...#.....#.#.#...#...#.#...#.#...#.#.#...#...#.#...#...#.#...#.#.#.#.#
#.#.#.#.###.###.#.#.#######.#.#.###.#.#####.#.#.#####.###.#########.#.###.#.###.#.#.###.#####.###.#.###.#.#.###.#.#.#.#########.###.#.#.#.#.#
#...#.....#.#.....#.#.......#.#.....#.....#.#.#.......#...#.......#.#...#.#...#...#...#...#...#.#.#.#.#.#.#.....#.#.#...#...#...#.#.#.#.#.#.#
#.#####.#.#.#.###.#.#.#######.#######.###.#.#######.###.#.#.#####.#####.#.###.#####.#.###.#.#.#.#.#.#.#.#.#######.#.###.#.#.#.###.#.#.###.#.#
#.#.....#...#.....#...#...#...#.....#.#...#.#.....#.#...#...#...........#.....#.#...#.#...#.#...#...#.#.#.....#...#...#...#...#...#.#.....#.#
#.#.#.#####.#####.#####.#.#.###.###.#.#.#.#.#.###.###.#######.#################.#.#.###.###.###.#####.#.#######.#####.#.#########.#.#####.#.#
#...#...........#.#...#.#.#...#.#...#.#.#.#...#.#.#...#.......#...#...........#...#...#...#...#.....#.#.........#.....#...#.......#.....#...#
#.#########.#.###.#.###.#.###.#.#####.#.#######.#.#.###.#######.#.#.#######.###.###.#.###.#.#.#####.#.###########.#######.#.###########.#.#.#
#.....#.......#...#.....#...#.#.......#.#.......#.#...#.#...#...#...#.....#...#.....#.#...#.#...#.........#.#.....#.#.......#.....#...#.#...#
#######.#.#.###.###########.#.#.#######.#.###.#.#.###.#.#.#.#.#######.###.###.#####.#.#.###.###.#########.#.#.#####.#.#####.#.###.#.#.#.###.#
#.......#.#.....#.......#.....#.#.....#...#...#.....#.#.#.#...#.#.....#.....#.#.....#...#...#.#...#...#.....#.....#.....#.......#...#.#.#...#
#.#.#####.#.#####.#####.#.###.#.###.#####.#.#######.#.#.#.#####.#.#####.###.#.#.#.#.#.###.#.#.###.#.#.###.#######.#####.#############.#.#.###
#.#.#.....................#...#...#.......#...........#.#...#.....#.....#.#.#...#.#.#.........#.#...#...#.#.....#.....#...............#.#.#.#
#.#.#.###.#.#.#.###.#.#####.#####.#####.#.#########.#####.#.###.#.#.#####.#.#####.#.#.#######.#.#######.###.#.#.#####.#############.###.#.#.#
#.#.#.#.#...#...#...#.........................#...................#.#...#.#.#.....#.........#...#.#.....#...#.#...#...#...........#.#...#.#.#
#.###.#.#.#######.###.###.#.#.#.#####.#.###.#.#.#.#.#.###.###.###.#.#.#.#.#.#.###.###.#####.###.#.#.#####.###.#.###.#########.###.#.#.###.#.#
#.#...#...........#.#.#...#.#.#.#...#.........................#...#.....#...............................#...#.#.#...#.......#...#...#.#.#...#
#.#.###.#.###.#####.#.#.#####.#.#.###.###.#.#####.#####.#.#######.#####.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.###.#####.###.#####.#.###.#
#.............................#.#...#.....#...#...#.....#...............#.#.#.#...#.....#.#...#.........#.#...#.#...#...#.#...#.#.....#.....#
#.#######.#####.###.###########.#.#.#.#######.#.###.#####.###.#.#.#######.#.#.###.#.#.###.###.###.#####.#.#.#######.###.#.###.#.#.#####.#####
#.#.......#.....#...#.#...#.....#.#...#.....#.#...#.........#.#.........#...#...#...#...#.#.#.#.#.....#.#.#.........#.......................#
#.###.###.#.#####.###.#.#.#.#########.#.###.#.###.###.#.###.###########.#.#####.#####.#.#.#.#.#.#####.#.#.###########.###.#.#########.###.#.#
#...........................#.......#.........#.#...#.#.#...#...#.....#.#.#...#.....#.#.....#.#.#.....#.#...#.....#...#.#...#...#.....#.#.#.#
###.#.#.#.#####.###.#.#.#####.#####.#####.#.#.#.#.###.#.#.#.#.#.#.###.#.#.#.#.#####.#########.#.#.#####.###.#.###.#.###.#.###.#.#.#####.#.#.#
#S....#.......#.......#...........#.......#.....#.......#.....#...#.....#...#.....#...........#.......#.......#.....#.........#...#.........#
#############################################################################################################################################`
