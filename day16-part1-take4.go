//go:build ignore

package main

import (
	"fmt"
	"maps"
	"strings"
)

var globalMinCost = -1

type movement int

const (
	direct movement = iota
	turnLeft
	turnRight
)

type node struct {
	sx, sy, dir  int
	nextMovement movement
}

type costOk struct {
	cost int
	ok   bool
}

type visitedNode struct {
	x, y int
	dir  int
}

var cachedCosts = make(map[node]costOk)

func main() {
	m, sx, sy, ex, ey := parseMap(ex2)
	cost, ok, _ := findPath(m, sx, sy, ex, ey, 1, make(map[visitedNode]bool), make(map[int]bool))

	fmt.Println(cost, ok)
	// fmt.Println(cachedCosts)
}

func cloneVisitedPath(m map[int]map[int]bool) map[int]map[int]bool {
	cloned := make(map[int]map[int]bool)
	for k, v := range m {
		cloned[k] = make(map[int]bool)
		for kk, vv := range v {
			cloned[k][kk] = vv
		}
	}

	return cloned
}

func cloneTurnedPath(m map[int]bool) map[int]bool {
	cloned := make(map[int]bool)
	for k, v := range m {
		cloned[k] = v
	}
	return cloned
}

func findPath(m [][]rune,
	sx, sy,
	ex, ey int,
	currentDir int,
	visitedPath map[visitedNode]bool,
	turnedPath map[int]bool,
) (int, bool, bool) { // cost, terminated, isloop
	if visitedPath[visitedNode{sx, sy, currentDir}] {
		fmt.Println("loop", sx, sy, currentDir)
		return 0, false, true
	}

	visitedPath[visitedNode{sx, sy, currentDir}] = true
	turnedPath[currentDir] = true

	if sx == ex && sy == ey {
		return 0, true, false
	}

	var costs []costOk

	// up
	if currentDir == 0 && m[sy-1][sx] != '#' {
		if cc, ok := cachedCosts[node{sx, sy, currentDir, direct}]; ok {
			costs = append(costs, costOk{cc.cost + 1, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok, loop := findPath(m, sx, sy-1, ex, ey, 0, clonedVisitedPath, newTurnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1, ok})
				cachedCosts[node{sx, sy, currentDir, direct}] = costOk{c, ok}
			}
		}
	}

	// right
	if currentDir == 1 && m[sy][sx+1] != '#' {
		if cc, ok := cachedCosts[node{sx, sy, currentDir, direct}]; ok {
			costs = append(costs, costOk{cc.cost + 1, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok, loop := findPath(m, sx+1, sy, ex, ey, 1, clonedVisitedPath, newTurnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1, ok})
				cachedCosts[node{sx, sy, currentDir, direct}] = costOk{c, ok}
			}
		}
	}

	// down
	if currentDir == 2 && m[sy+1][sx] != '#' {
		if cc, ok := cachedCosts[node{sx, sy, currentDir, direct}]; ok {
			costs = append(costs, costOk{cc.cost + 1, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok, loop := findPath(m, sx, sy+1, ex, ey, 2, clonedVisitedPath, newTurnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1, ok})
				cachedCosts[node{sx, sy, currentDir, direct}] = costOk{c, ok}
			}
		}
	}

	// left
	if currentDir == 3 && m[sy][sx-1] != '#' {
		if cc, ok := cachedCosts[node{sx - 1, sy, currentDir, direct}]; ok {
			costs = append(costs, costOk{cc.cost + 1, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			newTurnedPath := make(map[int]bool)
			c, ok, loop := findPath(m, sx-1, sy, ex, ey, 3, clonedVisitedPath, newTurnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1, ok})
				cachedCosts[node{sx, sy, currentDir, direct}] = costOk{c, ok}
			}
		}
	}

	// turn to up
	if (currentDir == 1 || currentDir == 3) && m[sy-1][sx] != '#' && !turnedPath[0] {
		var nextMovement movement
		if currentDir == 1 {
			nextMovement = turnLeft
		} else {
			nextMovement = turnRight
		}
		turnedPath[0] = true
		if cc, ok := cachedCosts[node{sx, sy, currentDir, nextMovement}]; ok {
			costs = append(costs, costOk{cc.cost + 1000, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			c, ok, loop := findPath(m, sx, sy, ex, ey, 0, clonedVisitedPath, turnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1000, ok})
				cachedCosts[node{sx, sy, currentDir, nextMovement}] = costOk{c, ok}
			}
		}
	}

	// turn to right
	if (currentDir == 0 || currentDir == 2) && m[sy][sx+1] != '#' && !turnedPath[1] {
		var nextMovement movement
		if currentDir == 0 {
			nextMovement = turnRight
		} else {
			nextMovement = turnLeft
		}
		turnedPath[1] = true
		if cc, ok := cachedCosts[node{sx, sy, currentDir, nextMovement}]; ok {
			costs = append(costs, costOk{cc.cost + 1000, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			c, ok, loop := findPath(m, sx, sy, ex, ey, 1, clonedVisitedPath, turnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1000, ok})
				cachedCosts[node{sx, sy, currentDir, nextMovement}] = costOk{c, ok}
			}
		}
	}

	// turn to down
	if (currentDir == 1 || currentDir == 3) && m[sy+1][sx] != '#' && !turnedPath[2] {
		var nextMovement movement
		if currentDir == 1 {
			nextMovement = turnRight
		} else {
			nextMovement = turnLeft
		}
		turnedPath[2] = true
		if cc, ok := cachedCosts[node{sx, sy, currentDir, nextMovement}]; ok {
			costs = append(costs, costOk{cc.cost + 1000, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			c, ok, loop := findPath(m, sx, sy, ex, ey, 2, clonedVisitedPath, turnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1000, ok})
				cachedCosts[node{sx, sy, currentDir, nextMovement}] = costOk{c, ok}
			}
		}
	}

	// turn to left
	if (currentDir == 0 || currentDir == 2) && m[sy][sx-1] != '#' && !turnedPath[3] {
		var nextMovement movement
		if currentDir == 0 {
			nextMovement = turnLeft
		} else {
			nextMovement = turnRight
		}
		turnedPath[3] = true
		if cc, ok := cachedCosts[node{sx, sy, currentDir, nextMovement}]; ok {
			costs = append(costs, costOk{cc.cost + 1000, cc.ok})
		} else {
			clonedVisitedPath := maps.Clone(visitedPath)
			c, ok, loop := findPath(m, sx, sy, ex, ey, 3, clonedVisitedPath, turnedPath)
			if !loop {
				costs = append(costs, costOk{c + 1000, ok})
				cachedCosts[node{sx, sy, currentDir, nextMovement}] = costOk{c, ok}
			}
		}
	}

	if len(costs) == 0 {
		return 0, false, false
	}

	var minCost costOk
	for _, c := range costs {
		if !minCost.ok && c.ok {
			minCost = c
			continue
		}

		if c.cost < minCost.cost && c.ok {
			minCost = c
		}
	}

	if minCost.ok {
		return minCost.cost, minCost.ok, false
	}

	return 0, false, false
}

func parseMap(input string) ([][]rune, int, int, int, int) {
	var m [][]rune
	var sx, sy, ex, ey int
	for y, l := range strings.Split(input, "\n") {
		m = append(m, []rune(l))
		for x, r := range []rune(l) {
			if r == 'S' {
				sx, sy = x, y
			}
			if r == 'E' {
				ex, ey = x, y
			}
		}
	}
	return m, sx, sy, ex, ey
}

var ex1 = `###############
#.......#....E#
#.#.###.#.###.#
#.....#.#...#.#
#.###.#####.#.#
#.#.#.......#.#
#.#.#####.###.#
#...........#.#
###.#.#####.#.#
#...#.....#.#.#
#.#.#.###.#.#.#
#.....#...#.#.#
#.###.#.#.#.#.#
#S..#.....#...#
###############`

var ex2 = `#################
#...#...#...#..E#
#.#.#.#.#.#.#.#.#
#.#.#.#...#...#.#
#.#.#.#.###.#.#.#
#...#.#.#.....#.#
#.#.#.#.#.#####.#
#.#...#.#.#.....#
#.#.#####.#.###.#
#.#.#.......#...#
#.#.###.#####.###
#.#.#...#.....#.#
#.#.#.#####.###.#
#.#.#.........#.#
#.#.#.#########.#
#S#.............#
#################`

var input = `#############################################################################################################################################
#.#...............#.........#.....#...........#.............#.............#.#.......#.#.........#...........#.......#...........#.........#E#
#.#.#.###########.#.#.#####.#.#.#.###.#####.#.#.#########.#.#.###.###.###.#.#.###.#.#.#.#.###.#.#.#######.#.#####.#.#.#.#.#.###.#.#.#####.#.#
#.#.#.....#.....#...#.....#.#...............#.#...#...#.....#.....#...#.#.#.#.#...#...........#.#.#.....#.#.#...#.#.#.#.#...#...#.#.#...#...#
#.#.#####.#.#######.#.###.#.#.#.#######.###.#.#.#.#.#.#.###########.###.#.#.#.#.###.#####.###.###.#.###.#.#.#.#.#.#.#.#.#.#.#.###.#.#.#####.#
#...#...#.#.....#...#...#.#.....#.....#.#.#...#.#.#.#.#.#.....#.....#.......#.#...#.#...#...#.....#...#.#.#...#.#.#...#.#.#.#.#...#.#.......#
#.###.#.#.#.###.#.#.#####.###.#####.#.#.#.#.###.#.#.#.#.###.#.#.#########.###.###.#.#.#.###.###########.#.#####.#.#######.#.#.#####.#.#######
#...#.#.#.#...#.#.........#.#.......#.#.#.......#.#.#.......................#.#.#.#.#.#...#...#.......#.#.#.....#.......#.#.#...#...#.#.....#
###.#.#.#.###.#.###.#######.#.#.###.###.#.#.#####.#####.#.###.#.#########.#.#.#.#.#.#.###.#.#.#.#####.#.#.#.#####.#####.#.#.###.#.###.#.###.#
#...#.#.#.#.#.#.....#.......#.#.#...#...#.#.....#.....#...#.#.#...........#.....#.#...#.#.#.....#.......#.#.#...#.....#...#.#.#.#...#...#.#.#
#.###.#.#.#.#.###.#.#.#.#####.#.#####.###.#.###.#####.#####.#.###.#######.#######.#####.#.#.#############.#.###.#####.#####.#.#.###.###.#.#.#
#.#...#...#.........................#...#.#...#.#.....#.....#...#.#...........................#...#.................#...#...#.#...#.......#.#
#.#.###.#######.#.#.#######.#.#####.###.###.#.#.#.#####.#######.###.#.###.#.###.#.#.###.#######.#.#.###.#.###.###.#.###.#.#.#.###.#########.#
#.#.#...#.....#.#.........#.....#.#...#...#...#...#...#.......#...#.#.......#.#.#.#...#.........#...#.....#.#.............#.......#.....#...#
#.#.#####.###.#.###.#####.#.#.#.#.###.###.#.#########.#.#####.###.#.#####.###.#.#.###.#.#############.#####.###.#.###.#.#.###.#####.###.#.###
#.........#.#.#...#...#...#.........#...#...#.#.......#.....#...#.#.#...#...#...#.......#.........#...#...#.....#...#...#...#...#...#...#...#
#.#########.#.###.###.#.#####.#######.#.#####.#.###.#######.#.###.#.#.###.#.#.#######.#.#.#######.#####.#.###.###########.#.###.#.###.###.#.#
#.#.#.....#.#.#.......#...#.........#.#.........#...#.....#.#...#...#...#.#.#.#.....#.#.........#.......#...#...........#.#.#.....#.#.#.#.#.#
#.#.#.#.#.#.#.#.###########.#####.#.#.###########.###.###.#.###.#####.#.#.#.#.#.#.#.#.###########.#########.###########.#.#.#.#####.#.#.#.#.#
#.#...#.#...#.#.#.........#.#.....#.#...#.....#...#.....#.#...#...#...#.#.#...#.#.#.#...#.......#.#...#...#.#...#.....#.#.#.#.......#.#...#.#
#.#####.###.#.###.#######.#.#.###.#.#####.###.#.#.#.#####.###.###.#.###.#.#######.#.#####.#####.###.#.#.#.#.#.#.#.#.#.#.###.#.###.###.#####.#
#.......#.#.#...........#...#.#...#.....#...#...#.#...#...#...#.#.#...#...#.....#.#.#.....#.....#...#.#...#.#.#...#...#.#...#...#...#.....#.#
#########.#.#############.###.#######.#.#.#.#########.#.###.###.#.###.#######.#.#.#.#.#####.#.###.###.#.#.#.#.#####.#.#.#.#######.#.#####.#.#
#.#.....#...#...........#.....#.....#.#.#.#.........#.#.....#...#.#...#.....#.#...#.#.....#...#.#...#.#.#...#.#.....#.#.#.......#.#.....#...#
#.#.#.###.###.#.#######.#######.###.###.#.#.#.#####.#.#######.#.#.#.###.###.#.#####.#.#.###.###.#.#.#.#.#####.#.#######.#######.#.###.#####.#
#...#...#.....#.....#.#.........#.#.#...#.....#...#.........#.#.#.......#.#...#...#.#.#...#.#.....#.#...#...#.#.......#.......#.#.#.#.......#
#.#####.#.###.#####.#.###########.#.#.###.#####.#.#########.#.#.#######.#.#####.#.#.#.###.#.#.#####.###.#.#.#.#######.#######.#.#.#.#########
#.#...#.#.......#...#.....#...#.......#.....#...#...#...#...#.#.........#.#.....#...#...#.#.#.....#...#...#.....#...#...#...#...#.........#.#
#.#.#.#.#.#####.#.#######.#.#.#.#############.###.#.###.#.#####.###.#####.#.###########.#.#.#########.#.#######.#.#.###.#.#.#############.#.#
#.#.#...#.....#.#...#...#...#...#.....#.......#...#...#.......#.#.#.#.#...#.#.......#...#.#...#...#...#.#.....#.#.#...#...#.......#.....#...#
###.#####.###.#.###.#.#.#.#######.###.#.#######.#####.#######.#.#.#.#.#.#.#.#.#####.#.###.###.#.#.#.#####.###.###.###.#####.#####.#.#.#####.#
#...#.....#.#...#.#...#.#...#.....#.#...#.......#...#...#...#.#.....#.......#...#...#...#.....#.#.#.#.......#...#...#.....#.........#.......#
#.#.#.###.#.#####.#####.###.#.#####.#######.#####.#.#.#.#.#.#.#####.#.#########.#.###.#.###.#.#.#.#.#.#####.#.#.###.#####.#######.#.#.#######
#.#.#.....#.#.........#.#.#.#...#.#.....#...#.....#.#.#.#.#.#.......#.#.........#...#.#...#.....#.#...#...#...#.........#.......#.#.........#
#.#######.#.#.#######.#.#.#.###.#.#.#.#.#.#.#.#####.#.#.###.#####.###.#######.#####.#####.#######.#####.#.###############.#####.#.#######.#.#
#.#.......#...#...#.....#...#...#...#.#...#.#...#.#.#.#...#.........#.......#...#.#.......#.....#.......#...........#.......#...#.........#.#
#.#.#.###.#.#####.#.#.#.#.###.#######.#####.###.#.#.#####.#####.#.#.#######.###.#.#########.#######################.#.#.###.#.###.#######.#.#
#...#...#.#.......#.#.#.#...#.......#...#...#...#.#.#...#.....#.#.#.......#...#.................#.........#.......#...#...#.#...#.......#.#.#
#.###.#.#.#######.#.###.###########.#.#.#.###.###.#.#.#.#.###.#.#.#.#####.###.#.#.###########.#.#.###.###.#.#####.#######.###.#.###.###.#.#.#
#.....#.#.........#...#.....#.....#.#.#.#.#...#...#...#.#.#...#...#.....#.#.#...#.#...........#...#...#.....#.#.........#.....#...#...#.....#
#####.#.#.#########.#.#####.#.###.#.#.#.###.###.#.#####.###.#####.#####.#.#.#######.#########.#####.###.#####.#.#####.#####.#.###.#.#####.###
#.....#.#...#.#...#.......#.....#.#.#.#.#...#...#.....#.....#...#.#.#...#...#.......#.....#.........#.#.#...#...#...#.#...#.#...........#...#
#.###.#.#.#.#.#.#.###.#.#.#######.#.###.#.###.#.###.#########.###.#.#.#####.#.#####.#####.#.#########.#.#.#.#####.#.#.#.#.#.###.#.#.#.#.#.#.#
#.#...#...#...#.#...#.#.#.....#...#...#.#...#.#...........#.....#.#.#.#.......#.........#.....#.....#...#.#.......#.#.#.#.....#.#.#.#.#...#.#
#.###.###.#####.###.#.#.#####.#.#####.#.###.#.#.#######.###.###.#.#.#.#########.#.#.###.#######.###.#.###.#########.###.#####.#.#.###.###.#.#
#...#...#.#.....#...#...#...#.#.....#...#...#.....#.......#.#.#.#...#.#.......#.#...#.#...........#.#...#.#.......#.....#.#.....#...#.#...#.#
#.#.#.###.#.#####.#####.#.#.#######.#.###.#######.#.#.###.#.#.#.###.#.#.#####.#.#####.###.#########.#####.#######.#######.#.#######.#.#.###.#
#.#.......#.....#.#.....#.#.....#.#.#.#...#.....#...#.#.#.#...#.....#...#.#...#...#...#.......#.....#...#.........#.......#...#...#.#.#...#.#
#.###.#####.###.#.###.###.###.#.#.#.#.#.###.###.###.#.#.#.###.###########.#.#.###.#.###.#####.#.###.#.#.#########.#.#####.###.#.#.#.#.###.#.#
#...#.....#.#...#...#.....#...#...#...#...#.#.#.#...#...#...................#...#.#.#...#.#...#...#.#.#.....#...#.#...#.....#...#.#.........#
###.#.###.###.#####.#.#####.#.###########.#.#.#.#.#####.###########.#.#####.###.#.#.#.###.#.#.###.#.#.#####.#.#.#.###.#.#.#######.#.#.#.#.###
#...#...#.....#...#.#.#.....#.#.......#...#.....#...#.......#...#...#.#.....#...#.#.#...#.#.#.#...#.#...#...#.#.#...#...#.......#.#.....#...#
#.###.#.#######.###.###.#######.#####.#.###.###.#.#.#.#####.#.#.#.#####.###.#.###.#.###.#.#.###.#######.#.###.#.###.#.#######.#.#.###.#####.#
#.#...#.#.....#.....#...#.......#.....#.#...#...#.#...#...#...#...#...#.#.#.#.....#.....#.#...#.........#.....#...#.#.....#...#...#.......#.#
#.#####.#####.#.#####.###.#.#.#####.###.#.###.###.#####.#.#########.#.#.#.#.#.#####.#####.#.#.#####.#.###########.#.#####.#.#.#####.#.###.#.#
#.....#.#...#.......#.#...#...#...#.#...#.#.#...#.#.....#...........#...#.#.#.#...#.#.......#...#...#.....#.....#...#...#.....#.....#...#.#.#
#####.#.#.#.#.#####.#.#.#######.#.#.###.#.#.###.#.#.###.#########.#######.#.#.#.#.#.#######.#.###.###.###.#.#.#.#######.#####.#.###.#.#.###.#
#.....#.#.#.#.......#.#.....#...#.#...#.#.#.#...#.#.#...#...#...#.#...#.....#.#.#...........#.#...#.......#.#.#.............#.#.#.#...#.#...#
#####.#.#.#.#.###.###.#####.#.#.#.###.#.#.#.#.###.#.#.###.#.#.#.###.#.#######.#############.#.#.###.#######.#.###########.###.#.#.#####.#.###
#...#.#...#.#.#...........#.....#.#...#.......#.#.#.#.#...#...#.#...#.......#...........#...#.#.....#...#.#.#...#.........#...#.....#...#...#
#.#.#.#####.#.#####.#.#######.###.#.#########.#.#.#.###.###.###.#.#########.###########.#####.#######.#.#.#.###.#######.###.###.#####.#####.#
#.#.#.....#.#.....#.#.#.....#.#...#...........#...#.......#.#...#.....#.......#.......#.........#.........#...#.......#.#...#...#...#.......#
#.#.#.###.#.###.#.###.#.###.###.#####.#####.###.#########.#.#.#######.#.###.###.#####.#########.###.#########.#.#.###.#.#.###.###.#.#.#.#.#.#
#.#.#.#.....#.........#.#.#...#.....#...#.....#.#.....#.#...#.......#.#.#...#...#...#.......#.#.....#.........#...#.#.#.#.#...#...#...#.#.#.#
#.#.#.#.#############.#.#.###.#####.#.#.#.###.#.#.#.#.#.###.#######.#.#.###.#.###.#.###.###.#.#.#.###.#########.#.#.#.#.#.#####.###.###.#.#.#
#.#.#.....#.........#.#.#...#.#.....#.#...#...#...#.#.#...........#...#.......#.#.#...#.#.....#.#.#.......#...#.....#.#.#...#...#...#...#...#
#.#.#.#.#.#.#######.#.#.#.###.#.#####.###########.#.#.###.###########.#####.###.#.#.#.#.#######.#.#.###.#.###.#######.#.###.#.#######.#####.#
#.#...#.#.#.#...#.#...#.#...#...#...#...#.......#.#.#...#.#.....#...#.........#.#.#...#.....#...#.......#.........#.....#.....#.....#...#...#
#.###.#.#.#.#.#.#.#.#.#.#.#.#####.#.#.#.#.###.###.#.###.#.#.###.#.#.#########.#.#.#.#.#####.#.###.###.###########.#.#####.#####.###.###.#.###
#.#...#...#.#.#...#.#.#.#.#.#.....#...#.....#.#...#...#.#.#.#.#...#.#.....#.#.#...#.#.....#...#.#.....#.........#.#.......#...#.#.......#.#.#
#.#.#.#####.#.#####.#.#.###.#.#############.#.#.#####.#.#.#.#.#####.#.###.#.#.#.###.###########.#######.#########.#########.#.#.#.#######.#.#
#.#.#.....#.#...#...#.#...#.#...#...#...#...#...#.....#.#.#.....#.#...#.#.....#...#.........#.....#...............#.#.......#.#.#.#...#...#.#
#.#.#.###.#.###.#.###.###.#.###.#.#.#.#.#####.###.#####.#######.#.#####.#.#.#.###.#########.#.###.#.#########.#.#.#.#.#######.#.###.#.#.###.#
#.#...#...#.#...#.#...#...#.....#...#.#.....#.#.#.#...#.#.....#...#...#.#.#.#...............#...#...#.......#.....#.#.#.......#.....#.#.#...#
#.###.#.###.#.#.#.#####.###.#######.#.#####.#.#.#.###.#.#.###.###.#.###.#.#.#.#########.#######.#####.#####.###.###.#.#.#.#####.#####.#.###.#
#.#.........#.#.#.....#.#.....#.....#.#.....#...#.....#.#.#...#.#.#...#.....#.#.......#.#.....#...#...#...#...#.....#.#...............#...#.#
#.###########.#.#####.#.###.#.#.#####.#.#.#######.#####.#.#.#.#.#.###.#####.#.#.#####.#.#.###.###.#.###.#.###.#####.#.#.#######.#########.#.#
#.#...#...#...#.#.....#...#.#...#...#.#.#.........#...#...#.#...#.....#.#...#.....#.#.#...#...#...#.#...#.........#.#...#.......#.........#.#
#.#.#.#.#.###.###.#######.#.###.#.#.#.#.###########.#.#####.#########.#.#.#######.#.#.###.#.###.###.###.#########.#.#.###.#####.#.#######.#.#
#.#.#.#.#...#...................#.#.#.#.........#.#.#...#...#.........#...#.......#.....#.#.....#.#...#.....#...#.#.......#.....#.#.....#...#
#.#.#.#.###.###########.#.#.#####.#.#.###.#####.#.#.###.#.#.#.#########.###.#.#########.#####.#.#.###.#######.#.#.#####.#####.#.###.###.###.#
#.#.#.#.#...#...#.....#...#.....#.#...#...#...#...#.#.#.....#...........#.#.#.......#.#...#...#...#.#.....#...#.#.............#.....#.#...#.#
#.#.#.#.#.###.#.###.#######.#####.#####.#.#.#.###.#.#.#####.#.###.#######.#.#######.#.###.#.#####.#.#####.#.###.#.###.#.#####.#.#####.###.###
#.#.#...#.....#...#.........#...#.#.....#...#...#.#.#.......#...#.#.....#...#.....#.#.......#...#...#...#...#...#...#.....#.#.#.....#...#...#
#.#.#########.###.#.#########.#.#.#.#.#.#.###.###.#.###########.#.#.###.#.###.###.#.###.#####.#.###.#.#.#####.#####.#####.#.#.#.###.#.#.###.#
#.#...#.......#...#.....#...#.#...#.#...#.........#.........#...#.#...#.#...#.#...#...#.#.....#.......#.#...#.#...#.#.....#...#.#.#...#.#...#
#.###.#.#.#.#.#.###.#####.#.#.#######.#######.#########.###.#.###.#.#.#.###.#.#.#####.###.###########.###.#.#.#.#.#.#.#.#.#.###.#.#####.#.#.#
#...#.#.#.....#.#...#.....#...#.....#.......#.#...#.......#...#.......#...#.#.#.....#.........#.#...#.#...#.#.#.#.....#...#.#...#.......#.#.#
#.###.#.###.#.#.#.###.#########.#.#.#######.#.#.#.#.#.#########.###.#####.#.###.#.###########.#.#.#.###.###.#.#.#####.#####.###.#.#######.#.#
#.............#.#...#.......#...#.#.....#...#...#.#.#.........#.....#.#...#...#.#.#.........#...#.#...#...#.#.#.#.....#...#...#.#.#...#.....#
#.#####.###.#.#.###.###.#.#.###.#.#####.#.#######.#.###.###.###.###.#.#.#####.###.#.###.###.#####.###.#.#.#.#.#.#.#####.#####.#.#.#.#.#.###.#
#...#...#...#...#.#.#.#.#.#.....#...#...#.......#...#...#...#...#...#.#.....#.....#.....#.......#.#...#...#...#.#.#...#.....#...#.#.#.#...#.#
#####.#.###.#.###.#.#.#.#.#######.#.#.###.#.###.#####.###.###.###.###.#####.#####.#####.#####.#.#.#.###.#######.#.###.#.#.#####.#.#.#.###.#.#
#...#.#.......#.......#...#.......#.#...#.....#.........#.#...#.....#.....#.....#.....#...#...#...#.#.........#.#...#.#.#.........#.#.#...#.#
#.#.#.#.###.###.###########.#######.###.#.#############.#.#.#######.###.#.#####.#####.###.#.#######.###.#####.#.###.#.#.#######.###.#.#.###.#
#.#...........#.#.................#.#...#.#.........#...#.#.........#...#...#.#.....#...#.#.......#...#.#.....#...#.#.#.#.......#...#...#.#.#
#.#####.###.#.###.#######.#######.###.#####.###.#.#.#####.###.#######.#####.#.#####.#####.#.###.#.#.#.#.#.#####.###.#.#.###.###.#.#######.#.#
#.#.....#...#.......#...#.#...#...#...#.....#.#...#...#.....#.#.....#.....#.#.....#.#.....#...#.#.....#.#.#...#.....#.#.#...#...#.#...#.....#
#.#.###.#.#.###.#####.#.###.#.#.#.#.#####.###.#######.#.#####.#.###.#####.#.#.###.#.#.#######.#.###.#.###.#.###.###.#.#.#.###.###.#.#.#.#####
#...#...#.............#.....#...#.#.#.....#.......#...#.......#.#.#...#...#...#.#.#.#...#...#.#...#.#.....#.....#.....#.#...#...#...#.#.....#
#.###.#.#.#.#.###.###############.#.###.###.#######.###.#####.#.#.###.#.#######.#.#.###.#.###.###.#########.#####.#.###.###.#######.#.#####.#
#...#.#...#.#.#...#.....#.....#...#.....#.........#.#...#...#...#.....#.......#...#.#...#.#...#.#.......#...#.....#...#...#.#.....#.#.....#.#
###.#######.#.#.###.#####.#.###.#################.#.#.###.#.###.#.#######.###.#####.#.###.#.###.#######.#.###.#######.###.#.#.#.###.#.#.###.#
#.#.........#.#.#...#...#.#.#...#...#.......#...#.#.......#.#...#...#.....#...#...#.#.#.......#.......#.#...#...#...#...#.#...#...#.#.#.#...#
#.###########.#.#.#.#.#.#.#.#.###.#.#.###.#.#.#.#.#########.#.#####.#.###.#.#.#.#.#.#.#######.###.#.###.###.#.###.#.#.#.#.###.###.#.#.#.#.###
#...#.........#.#.#.#.#...#.......#.#.#.#.#...#.#.....#...#.#...#.#...#...#.#.#.............#...#.#...#...#.#.#...#...#.#...#...#.#.#.#...#.#
#.#.#.#.#######.###.#.#.###########.#.#.#.#####.#.#.#.#.#.#.###.#.#####.###.###.###########.###.#####.###.#.#.#.###.#.#####.#####.#.###.#.#.#
#.....#.......#...#...........#.....#...#.#.....#...#.#.#.#.....#.#.....#...................#.#...#...#.#...#.#.....#.#...#.#.....#...#...#.#
#.#.###.#####.###.#####.#.#.#.#####.###.#.#.#########.#.#.#######.#.#####.###################.###.#.#.#.#####.#####.#.#.#.#.#.#######.###.#.#
#...#.........#.#...#.....#.#.....#.#...#.#.#...#.....#.#.......#...#.........#.......#.........#.#.#.#...#...#.#...#.#.#...#.......#...#...#
###.#.#.#####.#.###.#####.#.#####.#.###.#.#.#.#.#.###.#.###.###.#.#############.#####.#.#.#.#####.#.#.#.###.###.#.###.#.#########.#.###.#.#.#
#.................#...#...#.#.....#...#.#.#.#.#...#.#.#...#...#.#.#...........#.#.....#.#.........#.#.#...#...#.#...#.#.....#.....#.......#.#
#.#.###.###.#####.###.#####.#.#######.###.#.#.#####.#.###.###.#.#.###.#######.#.###.###.###########.#.#.#.###.#.###.#######.#.#.#######.#.#.#
#.#.....#...#...#...#...#...#.......#.....#.#.#.......#...#.#.#.......#.......#...#...#...#.....#...#.#.#...#.#...#.....#.#.#.#.#.....#.#.#.#
#.#.###.#.#.#.#.#.#####.#.#######.#.#######.#.###.#####.###.#.#########.#########.###.###.#.###.###.#.###.#.#.#.###.#.#.#.#.#.#.#.###.#.#.#.#
#.#...#...#...#.#.#.....#...#...#.#.#.....#.#...#...#.......#.........#...#.....#.#.#...#...#.#...#.#...#.#.#...#...#.#...#...#.#...#.#.#.#.#
#.#.#.#.###.###.#.#.#######.#.#.###.#.#####.#.#.#####.###.#########.#.###.#.###.#.#.###.#####.###.#.###.#.#.###.#.#.#.#########.###.#.#.#.#.#
#...#.....#.#.....#.#.......#.#.....#.....#.#.#.......#...#.......#.#...#.#...#...#...#...#...#.#.#.#.#.#.#.....#.#.#...#...#...#.#.#.#.#.#.#
#.#####.#.#.#.###.#.#.#######.#######.###.#.#######.###.#.#.#####.#####.#.###.#####.#.###.#.#.#.#.#.#.#.#.#######.#.###.#.#.#.###.#.#.###.#.#
#.#.....#...#.....#...#...#...#.....#.#...#.#.....#.#...#...#...........#.....#.#...#.#...#.#...#...#.#.#.....#...#...#...#...#...#.#.....#.#
#.#.#.#####.#####.#####.#.#.###.###.#.#.#.#.#.###.###.#######.#################.#.#.###.###.###.#####.#.#######.#####.#.#########.#.#####.#.#
#...#...........#.#...#.#.#...#.#...#.#.#.#...#.#.#...#.......#...#...........#...#...#...#...#.....#.#.........#.....#...#.......#.....#...#
#.#########.#.###.#.###.#.###.#.#####.#.#######.#.#.###.#######.#.#.#######.###.###.#.###.#.#.#####.#.###########.#######.#.###########.#.#.#
#.....#.......#...#.....#...#.#.......#.#.......#.#...#.#...#...#...#.....#...#.....#.#...#.#...#.........#.#.....#.#.......#.....#...#.#...#
#######.#.#.###.###########.#.#.#######.#.###.#.#.###.#.#.#.#.#######.###.###.#####.#.#.###.###.#########.#.#.#####.#.#####.#.###.#.#.#.###.#
#.......#.#.....#.......#.....#.#.....#...#...#.....#.#.#.#...#.#.....#.....#.#.....#...#...#.#...#...#.....#.....#.....#.......#...#.#.#...#
#.#.#####.#.#####.#####.#.###.#.###.#####.#.#######.#.#.#.#####.#.#####.###.#.#.#.#.#.###.#.#.###.#.#.###.#######.#####.#############.#.#.###
#.#.#.....................#...#...#.......#...........#.#...#.....#.....#.#.#...#.#.#.........#.#...#...#.#.....#.....#...............#.#.#.#
#.#.#.###.#.#.#.###.#.#####.#####.#####.#.#########.#####.#.###.#.#.#####.#.#####.#.#.#######.#.#######.###.#.#.#####.#############.###.#.#.#
#.#.#.#.#...#...#...#.........................#...................#.#...#.#.#.....#.........#...#.#.....#...#.#...#...#...........#.#...#.#.#
#.###.#.#.#######.###.###.#.#.#.#####.#.###.#.#.#.#.#.###.###.###.#.#.#.#.#.#.###.###.#####.###.#.#.#####.###.#.###.#########.###.#.#.###.#.#
#.#...#...........#.#.#...#.#.#.#...#.........................#...#.....#...............................#...#.#.#...#.......#...#...#.#.#...#
#.#.###.#.###.#####.#.#.#####.#.#.###.###.#.#####.#####.#.#######.#####.#.#.#.#.#.###.#.#.#.###.#.#.#.#.#.###.#.#.###.#####.###.#####.#.###.#
#.............................#.#...#.....#...#...#.....#...............#.#.#.#...#.....#.#...#.........#.#...#.#...#...#.#...#.#.....#.....#
#.#######.#####.###.###########.#.#.#.#######.#.###.#####.###.#.#.#######.#.#.###.#.#.###.###.###.#####.#.#.#######.###.#.###.#.#.#####.#####
#.#.......#.....#...#.#...#.....#.#...#.....#.#...#.........#.#.........#...#...#...#...#.#.#.#.#.....#.#.#.........#.......................#
#.###.###.#.#####.###.#.#.#.#########.#.###.#.###.###.#.###.###########.#.#####.#####.#.#.#.#.#.#####.#.#.###########.###.#.#########.###.#.#
#...........................#.......#.........#.#...#.#.#...#...#.....#.#.#...#.....#.#.....#.#.#.....#.#...#.....#...#.#...#...#.....#.#.#.#
###.#.#.#.#####.###.#.#.#####.#####.#####.#.#.#.#.###.#.#.#.#.#.#.###.#.#.#.#.#####.#########.#.#.#####.###.#.###.#.###.#.###.#.#.#####.#.#.#
#S....#.......#.......#...........#.......#.....#.......#.....#...#.....#...#.....#...........#.......#.......#.....#.........#...#.........#
#############################################################################################################################################`
